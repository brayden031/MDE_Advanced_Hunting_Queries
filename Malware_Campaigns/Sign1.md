# "Sign1" malware campaign

### These advanced hunts are based off the report released by Sucuri regarding a malware campaign called "sign1". The report these hunts are based off can be found at - https://blog.sucuri.net/2024/03/sign1-malware-analysis-campaign-history-indicators-of-compromise.html#

### This malware has compromised over 39,000 WordPress sites to lead users to unwanted redirects and popup ads posing significant security risks.

## Hunting endpoints for connection events to the IOC sites listed. This query is built in such a way that is shows any connection attempts seen in the last 7 days and it also collates the "ActionType" event to show which/if any didn't get blocked by ASR (if that has been setup for the specified environment).

```KQL
// Array for the IOCs listed
let sign1_urls = dynamic([
"js.abc-cdn.online",
"spf.js-min.site",
"cdn.jsdevlvr.info",
"cdn.wt-api.top",
"load.365analytics.xyz",
"stat.counter247.live",
"js.opttracker.online",
"l.js-assets.cloud",
"api.localadswidget.com",
"page.24supportkit.com",
"streaming.jsonmediapacks.com",
"js.schema-forms.org",
"stylesheet.webstaticcdn.com",
"assets.watchasync.com",
"tags.stickloader.info",
"apps.marketing-counter.com",
"forwardoffernow.com"
]);
// First search for determining any endpoint events observed
let ConnectionEvents = (
search in (DeviceNetworkEvents, DeviceProcessEvents, DeviceFileEvents, DeviceEvents)
Timestamp between (ago(7d) .. now())
| where RemoteUrl has_any (sign1_urls)
or FileOriginUrl has_any (sign1_urls)
or FileOriginReferrerUrl has_any (sign1_urls)
| project RemoteUrl, ActionType
);
// Second search for checking whether ASR was enforced
search in (DeviceNetworkEvents, DeviceProcessEvents, DeviceFileEvents, DeviceEvents)
Timestamp between (ago(7d) .. now())
| where RemoteUrl in (ConnectionEvents)
| summarize ActionType=make_set(ActionType) by DeviceName, RemoteUrl
// Limiting to 10 to simplify results, remove to see all events if applicable
| limit 10
```

## If from the search above you have retrieved any events that only show "Connection success", hunt using the query below to help further investigate the event by pulling fields such as; time, localIP, localPort, RemoteIP

```KQL
search in (DeviceNetworkEvents, DeviceProcessEvents, DeviceFileEvents, DeviceEvents)
Timestamp between (ago(7d) .. now())
// Replace "Enter URL" below with the sign1 url you have observed
| where RemoteUrl contains @"Enter URL"
or FileOriginUrl contains @"Enter URL"
or FileOriginReferrerUrl contains @"Enter URL"
| project Timestamp, DeviceId, DeviceName, LocalIP, LocalPort, RemoteIP, InitiatingProcessFileName, InitiatingProcessFolderPath, InitiatingProcessParentFileName
```

Created by Brayden & @Hxber
